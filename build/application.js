// Generated by CoffeeScript 1.6.1
(function() {
  'use-strict';
  var callback_check_and_addRelator, check_and_addRelator, initialize_extension, loadRelators;

  initialize_extension = function() {
    return loadRelators(localStorage["registered_user_id"]);
  };

  document.addEventListener("DOMContentLoaded", initialize_extension);

  chrome.runtime.onMessage.addListener(function(request, sender, sendResponse) {
    var message_collection, message_collection_view;
    if (request.messages_loaded) {
      message_collection = chrome.extension.getBackgroundPage().messages_with_options;
      console.log(message_collection);
      message_collection_view = new MessageCollectionView({
        "collection": message_collection
      });
      return $("#messages_container").html(message_collection_view.render().el);
    }
  });

  loadRelators = function(user_id) {
    var relater_collection;
    relater_collection = new RelaterCollection({
      "user_id": user_id
    });
    return relater_collection.fetch({
      success: function() {
        var relater_collection_view;
        relater_collection_view = new RelatersCollectionView({
          "collection": relater_collection
        });
        return $("#contacts_container").html(relater_collection_view.render().el);
      }
    });
  };

  check_and_addRelator = function(add_relator_id) {
    var data, url;
    data = {
      relator_id: add_relator_id
    };
    url = chrome.extension.getBackgroundPage().base_url + "/calltheteam/addcontact";
    return $.post(url, data, callback_check_and_addRelator);
  };

  callback_check_and_addRelator = function(response_data) {};

}).call(this);
