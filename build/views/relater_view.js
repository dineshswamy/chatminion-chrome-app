// Generated by CoffeeScript 1.6.1
(function() {
  var __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  this.RelaterView = (function(_super) {

    __extends(RelaterView, _super);

    function RelaterView() {
      return RelaterView.__super__.constructor.apply(this, arguments);
    }

    RelaterView.prototype.events = {
      "click": "loadMessages",
      "click .video_call_icon": "start_video_call"
    };

    RelaterView.prototype.tagName = "a";

    RelaterView.prototype.className = "list-group-item";

    RelaterView.prototype.attributes = function() {
      return {
        'data-relater-id': this.model.id
      };
    };

    RelaterView.prototype.initialize = function(attributes) {
      return this.listenTo(Backbone, 'loadMessages', this.loadMessages);
    };

    RelaterView.prototype.render = function() {
      this.$el.html(HAML["relater"]({
        user_model: this.model
      }));
      return this;
    };

    RelaterView.prototype.loadMessages = function(event) {
      this.$el.siblings().removeClass("active");
      window.message_to_send = null;
      this.$el.addClass("active");
      this.$el.siblings().find(".video_call_icon").css("visibility", "hidden");
      this.$el.find(".video_call_icon").css("visibility", "visible");
      window.peer_js_selected_relater = this.model;
      return window.loadMessagesofRelater(this.model.id);
    };

    RelaterView.prototype.start_video_call = function(event) {
      var alert_view, message;
      if (event.target && event.target.nodeName === "SPAN") {
        alert_view = new AlertView();
        message = "Connecting ...";
        $("#sign_up_view").html(alert_view.render(message).$el);
        alert_view.hide_okay_button();
        $("#sign_up_view_modal").modal({
          keyboard: false
        });
        $("#sign_up_view_modal").modal('show');
        return window.launchVideoCall(event);
      }
    };

    return RelaterView;

  })(Backbone.View);

}).call(this);
